---
layout:     post
title:      æ·±å…¥åˆ†æJSå†…ç½®å¯¹è±¡(ä¸€)
subtitle:   JavaScriptæ ‡å‡†åº“å†…ç½®å¯¹è±¡åˆ†æä¹‹Functionçš„apply()
date:       2019-07-01
author:     Aro
header-img: img/post-bg-js-version.jpg
catalog: true
tags:
    - JS
    - å‰ç«¯
---


## `Function.prototype.apply()`

`apply()`æ–¹æ³•è°ƒç”¨ä¸€ä¸ªå…·æœ‰ç»™å®š`this`å€¼çš„å‡½æ•°ï¼Œä»¥åŠä½œä¸ºä¸€ä¸ªæ•°ç»„ï¼ˆæˆ–ç±»ä¼¼æ•°ç»„å¯¹è±¡ï¼‰æä¾›çš„å‚æ•°ã€‚

>æ³¨æ„ï¼š`call()`æ–¹æ³•çš„ä½œç”¨å’Œ`apply()`æ–¹æ³•ç±»ä¼¼ï¼ŒåŒºåˆ«å°±æ˜¯`call()`æ–¹æ³•æ¥å—çš„æ˜¯å‚æ•°åˆ—è¡¨ï¼Œè€Œ`apply()`æ–¹æ³•æ¥å—çš„æ˜¯ä¸€ä¸ªå‚æ•°æ•°ç»„ã€‚

**ä¸¾å‡ ä¸ªç®€å•ä¾‹å­æ¥è¯´ä¸€è¯´`apply()`çš„ä½¿ç”¨:**

#### æ±‚æ•°ç»„çš„æœ€å¤§å€¼

```js
var numbers = [5, 6, 2, 3, 7];

var max = Math.max.apply(null, numbers);

console.log(max);
// expected output: 7

var min = Math.min.apply(null, numbers);

console.log(min);
// expected output: 2
```

#### è‡ªå·±å®ç°ä¸€ä¸ªæ•ˆæœ

```js
var obj = {
    name : 'add'
}

function func(firstName, lastName){
    console.log(firstName + ' ' + this.name + ' ' + lastName);
}

func.apply(obj, ['A', 'B']);    // A add B
```

å¯ä»¥çœ‹åˆ°ï¼Œ`obj`æ˜¯ä½œä¸ºå‡½æ•°ä¸Šä¸‹æ–‡çš„å¯¹è±¡ï¼Œå‡½æ•°`func`ä¸­`this`æŒ‡å‘äº†`obj`è¿™ä¸ªå¯¹è±¡ã€‚å‚æ•° A å’Œ B æ˜¯æ”¾åœ¨æ•°ç»„ä¸­ä¼ å…¥`func`å‡½æ•°ï¼Œåˆ†åˆ«å¯¹åº”`func`å‚æ•°çš„åˆ—è¡¨å…ƒç´ ã€‚


#### å¯¹æ¯”`call()`

call æ–¹æ³•ç¬¬ä¸€ä¸ªå‚æ•°ä¹Ÿæ˜¯ä½œä¸ºå‡½æ•°ä¸Šä¸‹æ–‡çš„å¯¹è±¡ï¼Œä½†æ˜¯åé¢ä¼ å…¥çš„æ˜¯ä¸€ä¸ªå‚æ•°åˆ—è¡¨ï¼Œè€Œä¸æ˜¯å•ä¸ªæ•°ç»„ã€‚

```js
var obj = {
    name: 'add'
}

function func(firstName, lastName) {
    console.log(firstName + ' ' + this.name + ' ' + lastName);
}

func.call(obj, 'C', 'D');       // C add D
```

å¯¹æ¯” apply æˆ‘ä»¬å¯ä»¥çœ‹åˆ°åŒºåˆ«ï¼ŒC å’Œ D æ˜¯ä½œä¸ºå•ç‹¬çš„å‚æ•°ä¼ ç»™ func å‡½æ•°ï¼Œè€Œä¸æ˜¯æ”¾åˆ°æ•°ç»„ä¸­ã€‚

å¯¹äºä»€ä¹ˆæ—¶å€™è¯¥ç”¨ä»€ä¹ˆæ–¹æ³•ï¼Œå…¶å®ä¸ç”¨çº ç»“ã€‚å¦‚æœä½ çš„å‚æ•°æœ¬æ¥å°±å­˜åœ¨ä¸€ä¸ªæ•°ç»„ä¸­ï¼Œé‚£è‡ªç„¶å°±ç”¨ applyï¼Œå¦‚æœå‚æ•°æ¯”è¾ƒæ•£ä¹±ç›¸äº’ä¹‹é—´æ²¡ä»€ä¹ˆå…³è”ï¼Œå°±ç”¨ callã€‚


## è¯­æ³•

>func.apply(thisArg, [argsArray])

#### å‚æ•°

**thisArg:**
å¯é€‰çš„ã€‚åœ¨ func å‡½æ•°è¿è¡Œæ—¶ä½¿ç”¨çš„ this å€¼ã€‚è¯·æ³¨æ„ï¼Œthiså¯èƒ½ä¸æ˜¯è¯¥æ–¹æ³•çœ‹åˆ°çš„å®é™…å€¼ï¼šå¦‚æœè¿™ä¸ªå‡½æ•°å¤„äºéä¸¥æ ¼æ¨¡å¼ä¸‹ï¼Œåˆ™æŒ‡å®šä¸º null æˆ– undefined æ—¶ä¼šè‡ªåŠ¨æ›¿æ¢ä¸ºæŒ‡å‘å…¨å±€å¯¹è±¡ï¼ŒåŸå§‹å€¼ä¼šè¢«åŒ…è£…ã€‚

**argsArray:**
å¯é€‰çš„ã€‚ä¸€ä¸ªæ•°ç»„æˆ–è€…ç±»æ•°ç»„å¯¹è±¡ï¼Œå…¶ä¸­çš„æ•°ç»„å…ƒç´ å°†ä½œä¸ºå•ç‹¬çš„å‚æ•°ä¼ ç»™`func`å‡½æ•°ã€‚å¦‚æœè¯¥å‚æ•°çš„å€¼ä¸º`null`æˆ–`undefined`ï¼Œåˆ™è¡¨ç¤ºä¸éœ€è¦ä¼ å…¥ä»»ä½•å‚æ•°ã€‚

#### è¿”å›å€¼

è°ƒç”¨æœ‰æŒ‡å®š`this`å€¼å’Œå‚æ•°çš„å‡½æ•°çš„ç»“æœã€‚


## æè¿°

åœ¨è°ƒç”¨ä¸€ä¸ªå­˜åœ¨çš„å‡½æ•°æ—¶ï¼Œä½ å¯ä»¥ä¸ºå…¶æŒ‡å®šä¸€ä¸ª this å¯¹è±¡ã€‚ this æŒ‡å½“å‰å¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯æ­£åœ¨è°ƒç”¨è¿™ä¸ªå‡½æ•°çš„å¯¹è±¡ã€‚ ä½¿ç”¨ applyï¼Œ ä½ å¯ä»¥åªå†™ä¸€æ¬¡è¿™ä¸ªæ–¹æ³•ç„¶ååœ¨å¦ä¸€ä¸ªå¯¹è±¡ä¸­ç»§æ‰¿å®ƒï¼Œè€Œä¸ç”¨åœ¨æ–°å¯¹è±¡ä¸­é‡å¤å†™è¯¥æ–¹æ³•ã€‚

`apply()`ä¸`call()`éå¸¸ç›¸ä¼¼ï¼Œä¸åŒä¹‹å¤„åœ¨äºæä¾›å‚æ•°çš„æ–¹å¼ã€‚`apply`ä½¿ç”¨å‚æ•°æ•°ç»„è€Œä¸æ˜¯ä¸€ç»„å‚æ•°åˆ—è¡¨ã€‚`apply`å¯ä»¥ä½¿ç”¨æ•°ç»„å­—é¢é‡`ï¼ˆarray literalï¼‰`ï¼Œå¦‚ `fun.apply(this, ['eat', 'bananas'])`ï¼Œæˆ–æ•°ç»„å¯¹è±¡ï¼Œ å¦‚  `fun.apply(this, new Array('eat', 'bananas'))`ã€‚

ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨`arguments`å¯¹è±¡ä½œä¸º`argsArray`å‚æ•°ã€‚ `arguments`æ˜¯ä¸€ä¸ªå‡½æ•°çš„å±€éƒ¨å˜é‡ã€‚ å®ƒå¯ä»¥è¢«ç”¨ä½œè¢«è°ƒç”¨å¯¹è±¡çš„æ‰€æœ‰æœªæŒ‡å®šçš„å‚æ•°ã€‚ è¿™æ ·ï¼Œä½ åœ¨ä½¿ç”¨applyå‡½æ•°çš„æ—¶å€™å°±ä¸éœ€è¦çŸ¥é“è¢«è°ƒç”¨å¯¹è±¡çš„æ‰€æœ‰å‚æ•°ã€‚ ä½ å¯ä»¥ä½¿ç”¨argumentsæ¥æŠŠæ‰€æœ‰çš„å‚æ•°ä¼ é€’ç»™è¢«è°ƒç”¨å¯¹è±¡ã€‚ è¢«è°ƒç”¨å¯¹è±¡æ¥ä¸‹æ¥å°±è´Ÿè´£å¤„ç†è¿™äº›å‚æ•°ã€‚

ä» ECMAScript ç¬¬5ç‰ˆå¼€å§‹ï¼Œå¯ä»¥ä½¿ç”¨ä»»ä½•ç§ç±»çš„ç±»æ•°ç»„å¯¹è±¡ï¼Œå°±æ˜¯è¯´åªè¦æœ‰ä¸€ä¸ª length å±æ€§å’Œ(0..length-1)èŒƒå›´çš„æ•´æ•°å±æ€§ã€‚ä¾‹å¦‚ç°åœ¨å¯ä»¥ä½¿ç”¨ NodeList æˆ–ä¸€ä¸ªè‡ªå·±å®šä¹‰çš„ç±»ä¼¼ {'length': 2, '0': 'eat', '1': 'bananas'} å½¢å¼çš„å¯¹è±¡ã€‚


>éœ€è¦æ³¨æ„ï¼šChrome 14 ä»¥åŠ Internet Explorer 9 ä»ç„¶ä¸æ¥å—ç±»æ•°ç»„å¯¹è±¡ã€‚å¦‚æœä¼ å…¥ç±»æ•°ç»„å¯¹è±¡ï¼Œå®ƒä»¬ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚


## å†ä¸¾å‡ ä¸ªä¾‹å­ğŸŒ°

#### ç”¨`apply`å°†æ•°ç»„æ·»åŠ åˆ°å¦ä¸€ä¸ªæ•°ç»„

æˆ‘ä»¬å¯ä»¥ä½¿ç”¨`push`å°†å…ƒç´ è¿½åŠ åˆ°æ•°ç»„ä¸­ã€‚å¹¶ä¸”ï¼Œå› ä¸ºpushæ¥å—å¯å˜æ•°é‡çš„å‚æ•°ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ä¸€æ¬¡æ¨é€å¤šä¸ªå…ƒç´ ã€‚ä½†æ˜¯ï¼Œå¦‚æœæˆ‘ä»¬ä¼ é€’ä¸€ä¸ªæ•°ç»„æ¥æ¨é€ï¼Œå®ƒå®é™…ä¸Šä¼šå°†è¯¥æ•°ç»„ä½œä¸ºå•ä¸ªå…ƒç´ æ·»åŠ ï¼Œè€Œä¸æ˜¯å•ç‹¬æ·»åŠ å…ƒç´ ï¼Œå› æ­¤æˆ‘ä»¬æœ€ç»ˆå¾—åˆ°ä¸€ä¸ªæ•°ç»„å†…çš„æ•°ç»„ã€‚å¦‚æœé‚£ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„æ€ä¹ˆåŠï¼Ÿåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œ`concat`ç¡®å®å…·æœ‰æˆ‘ä»¬æƒ³è¦çš„è¡Œä¸ºï¼Œä½†å®ƒå®é™…ä¸Šå¹¶ä¸é™„åŠ åˆ°ç°æœ‰æ•°ç»„ï¼Œè€Œæ˜¯åˆ›å»ºå¹¶è¿”å›ä¸€ä¸ªæ–°æ•°ç»„ã€‚ ä½†æ˜¯æˆ‘ä»¬æƒ³è¦é™„åŠ åˆ°æˆ‘ä»¬ç°æœ‰çš„é˜µåˆ—......é‚£ä¹ˆç°åœ¨å‘¢ï¼Ÿ å†™ä¸€ä¸ªå¾ªç¯ï¼Ÿå½“ç„¶ä¸æ˜¯å—ï¼Ÿ

applyæ¥å¸®ä½ ï¼

```js
var array = ['a', 'b'];
var array2 = [0, 1, 2];
array.push.apply(array, array2);
console.info(array); // ["a", "b", 0, 1, 2]
```

#### ä½¿ç”¨`apply`å’Œå†…ç½®å‡½æ•°

èªæ˜çš„applyç”¨æ³•å…è®¸ä½ åœ¨æŸäº›æœ¬æ¥éœ€è¦å†™æˆéå†æ•°ç»„å˜é‡çš„ä»»åŠ¡ä¸­ä½¿ç”¨å†…å»ºçš„å‡½æ•°ã€‚åœ¨æ¥ä¸‹é‡Œçš„ä¾‹å­ä¸­æˆ‘ä»¬ä¼šä½¿ç”¨Math.max/Math.minæ¥æ‰¾å‡ºä¸€ä¸ªæ•°ç»„ä¸­çš„æœ€å¤§/æœ€å°å€¼ã€‚

```js
/* æ‰¾å‡ºæ•°ç»„ä¸­æœ€å¤§/å°çš„æ•°å­— */
var numbers = [5, 6, 2, 3, 7];

/* åº”ç”¨(apply) Math.min/Math.max å†…ç½®å‡½æ•°å®Œæˆ */
var max = Math.max.apply(null, numbers); /* åŸºæœ¬ç­‰åŒäº Math.max(numbers[0], ...) æˆ– Math.max(5, 6, ..) */
var min = Math.min.apply(null, numbers);

/* ä»£ç å¯¹æ¯”ï¼š ç”¨ç®€å•å¾ªç¯å®Œæˆ */
max = -Infinity, min = +Infinity;

for (var i = 0; i < numbers.length; i++) {
  if (numbers[i] > max)
    max = numbers[i];
  if (numbers[i] < min) 
    min = numbers[i];
}

/* ä»£ç å¯¹æ¯”es6ä½¿ç”¨æ•°ç»„çš„æ‰©å±• */
var max_2 = Math.max(...numbers);

console.log(max_2);
// expected output: 7
```

ä½†æ˜¯å½“å¿ƒï¼šå¦‚æœç”¨ä¸Šé¢çš„æ–¹å¼è°ƒç”¨applyï¼Œä¼šæœ‰è¶…å‡ºJavaScriptå¼•æ“çš„å‚æ•°é•¿åº¦é™åˆ¶çš„é£é™©ã€‚å½“ä½ å¯¹ä¸€ä¸ªæ–¹æ³•ä¼ å…¥éå¸¸å¤šçš„å‚æ•°ï¼ˆæ¯”å¦‚ä¸€ä¸‡ä¸ªï¼‰æ—¶ï¼Œå°±éå¸¸æœ‰å¯èƒ½ä¼šå¯¼è‡´è¶Šç•Œé—®é¢˜, è¿™ä¸ªä¸´ç•Œå€¼æ˜¯æ ¹æ®ä¸åŒçš„ JavaScript å¼•æ“è€Œå®šçš„ï¼ˆJavaScript æ ¸å¿ƒä¸­å·²ç»åšäº†ç¡¬ç¼–ç   å‚æ•°ä¸ªæ•°é™åˆ¶åœ¨65536ï¼‰ï¼Œå› ä¸ºè¿™ä¸ªé™åˆ¶ï¼ˆå®é™…ä¸Šä¹Ÿæ˜¯ä»»ä½•ç”¨åˆ°è¶…å¤§æ ˆç©ºé—´çš„è¡Œä¸ºçš„è‡ªç„¶è¡¨ç°ï¼‰æ˜¯æœªæŒ‡å®šçš„. æœ‰äº›å¼•æ“ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚æ›´ç³Ÿç³•çš„æ˜¯å…¶ä»–å¼•æ“ä¼šç›´æ¥é™åˆ¶ä¼ å…¥åˆ°æ–¹æ³•çš„å‚æ•°ä¸ªæ•°ï¼Œå¯¼è‡´å‚æ•°ä¸¢å¤±ã€‚ä¸¾ä¸ªä¾‹å­ï¼šå¦‚æœæŸä¸ªå¼•æ“é™åˆ¶äº†æ–¹æ³•å‚æ•°æœ€å¤šä¸º4ä¸ªï¼ˆå®é™…çœŸæ­£çš„å‚æ•°ä¸ªæ•°é™åˆ¶å½“ç„¶è¦é«˜å¾—å¤šäº†, è¿™é‡Œåªæ˜¯æ‰“ä¸ªæ¯”æ–¹ï¼‰, ä¸Šé¢çš„ä»£ç ä¸­, çœŸæ­£é€šè¿‡ applyä¼ åˆ°ç›®æ ‡æ–¹æ³•ä¸­çš„å‚æ•°ä¸º 5, 6, 2, 3 è€Œä¸æ˜¯å®Œæ•´çš„æ•°ç»„ã€‚

å¦‚æœä½ çš„å‚æ•°æ•°ç»„å¯èƒ½éå¸¸å¤§ï¼Œé‚£ä¹ˆæ¨èä½¿ç”¨ä¸‹é¢è¿™ç§ç­–ç•¥æ¥å¤„ç†ï¼šå°†å‚æ•°æ•°ç»„åˆ‡å—åå¾ªç¯ä¼ å…¥ç›®æ ‡æ–¹æ³•ï¼š

```js
function minOfArray(arr) {
  var min = Infinity;
  var QUANTUM = 32768;

  for (var i = 0, len = arr.length; i < len; i += QUANTUM) {
    var submin = Math.min.apply(null, arr.slice(i, Math.min(i + QUANTUM, len)));
    min = Math.min(submin, min);
  }

  return min;
}

var min = minOfArray([5, 6, 2, 3, 7]);
```

#### ä½¿ç”¨`apply`æ¥é“¾æ¥æ„é€ å™¨

ä½ å¯ä»¥ä½¿ç”¨applyæ¥é“¾æ¥ä¸€ä¸ªå¯¹è±¡æ„é€ å™¨ï¼Œç±»ä¼¼äºJavaã€‚åœ¨æ¥ä¸‹æ¥çš„ä¾‹å­ä¸­æˆ‘ä»¬ä¼šåˆ›å»ºä¸€ä¸ªå…¨å±€`Function`å¯¹è±¡çš„constructæ–¹æ³• ï¼Œæ¥ä½¿ä½ èƒ½å¤Ÿåœ¨æ„é€ å™¨ä¸­ä½¿ç”¨ä¸€ä¸ªç±»æ•°ç»„å¯¹è±¡è€Œéå‚æ•°åˆ—è¡¨ã€‚

```js
Function.prototype.construct = function (aArgs) {
  var oNew = Object.create(this.prototype);
  this.apply(oNew, aArgs);
  return oNew;
};
```

#### æ”¹å˜`this`çš„æŒ‡å‘

```js
var obj = {
    name: 'aro'
}

function func() {
    console.log(this.name);
}

func.call(obj);       // aro
```

æˆ‘ä»¬çŸ¥é“ï¼Œcall æ–¹æ³•çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ä½œä¸ºå‡½æ•°ä¸Šä¸‹æ–‡çš„å¯¹è±¡ï¼Œè¿™é‡ŒæŠŠ obj ä½œä¸ºå‚æ•°ä¼ ç»™äº† funcï¼Œæ­¤æ—¶å‡½æ•°é‡Œçš„ this ä¾¿æŒ‡å‘äº† obj å¯¹è±¡ã€‚æ­¤å¤„ func å‡½æ•°é‡Œå…¶å®ç›¸å½“äº

```js
function func() {
    console.log(obj.name);
}
```

#### å€Ÿç”¨åˆ«çš„å¯¹è±¡çš„æ–¹æ³•

```js
var Person1  = function () {
    this.name = 'aro';
}
var Person2 = function () {
    this.getname = function () {
        console.log(this.name);
    }
    Person1.call(this);
}
var person = new Person2();
person.getname();       // aro
```

ä»ä¸Šé¢æˆ‘ä»¬çœ‹åˆ°ï¼ŒPerson2 å®ä¾‹åŒ–å‡ºæ¥çš„å¯¹è±¡ person é€šè¿‡ getname æ–¹æ³•æ‹¿åˆ°äº† Person1 ä¸­çš„ nameã€‚å› ä¸ºåœ¨ Person2 ä¸­ï¼ŒPerson1.call(this) çš„ä½œç”¨å°±æ˜¯ä½¿ç”¨ Person1 å¯¹è±¡ä»£æ›¿ this å¯¹è±¡ï¼Œé‚£ä¹ˆ Person2 å°±æœ‰äº† Person1 ä¸­çš„æ‰€æœ‰å±æ€§å’Œæ–¹æ³•äº†ï¼Œç›¸å½“äº Person2 ç»§æ‰¿äº† Person1 çš„å±æ€§å’Œæ–¹æ³•ã€‚


#### è°ƒç”¨å‡½æ•°

applyã€call æ–¹æ³•éƒ½ä¼šä½¿å‡½æ•°ç«‹å³æ‰§è¡Œï¼Œå› æ­¤å®ƒä»¬ä¹Ÿå¯ä»¥ç”¨æ¥è°ƒç”¨å‡½æ•°ã€‚

```js
function func() {
    console.log('aro');
}
func.call();            // aro
```


## `call`å’Œ`bind`çš„åŒºåˆ«

åœ¨ EcmaScript5 ä¸­æ‰©å±•äº†å« bind çš„æ–¹æ³•ï¼Œåœ¨ä½ç‰ˆæœ¬çš„ IE ä¸­ä¸å…¼å®¹ã€‚å®ƒå’Œ call å¾ˆç›¸ä¼¼ï¼Œæ¥å—çš„å‚æ•°æœ‰ä¸¤éƒ¨åˆ†ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯æ˜¯ä½œä¸ºå‡½æ•°ä¸Šä¸‹æ–‡çš„å¯¹è±¡ï¼Œç¬¬äºŒéƒ¨åˆ†å‚æ•°æ˜¯ä¸ªåˆ—è¡¨ï¼Œå¯ä»¥æ¥å—å¤šä¸ªå‚æ•°ã€‚
å®ƒä»¬ä¹‹é—´çš„åŒºåˆ«æœ‰ä»¥ä¸‹ä¸¤ç‚¹ã€‚

#### `bind`å‘è¿”å›å€¼æ˜¯å‡½æ•°

```js
var obj = {
    name: 'aro'
}

function func() {
    console.log(this.name);
}

var func1 = func.bind(obj);
func1();                        // aro
```

`bind`æ–¹æ³•ä¸ä¼šç«‹å³æ‰§è¡Œï¼Œè€Œæ˜¯è¿”å›ä¸€ä¸ªæ”¹å˜äº†ä¸Šä¸‹æ–‡`this`åçš„å‡½æ•°ã€‚è€ŒåŸå‡½æ•°`func`ä¸­çš„`this`å¹¶æ²¡æœ‰è¢«æ”¹å˜ï¼Œä¾æ—§æŒ‡å‘å…¨å±€å¯¹è±¡`window`ã€‚


#### å‚æ•°çš„ä½¿ç”¨

```js
function func(a, b, c) {
    console.log(a, b, c);
}
var func1 = func.bind(null,'aro');

func('A', 'B', 'C');            // A B C
func1('A', 'B', 'C');           // aro A B
func1('B', 'C');                // aro B C
func.call(null, 'aro');      // aro undefined undefined
```

`call`æ˜¯æŠŠç¬¬äºŒä¸ªåŠä»¥åçš„å‚æ•°ä½œä¸º`func`æ–¹æ³•çš„å®å‚ä¼ è¿›å»ï¼Œè€Œ`func1`æ–¹æ³•çš„å®å‚åˆ™æ˜¯åœ¨`bind`ä¸­å‚æ•°çš„åŸºç¡€ä¸Šå†å¾€åæ’ã€‚

#### ä¸ºä½ç‰ˆæœ¬æµè§ˆå™¨å®ç°ä¸€ä¸ªbind(Polyfill)

```js
if (!Function.prototype.bind) {
  Function.prototype.bind = function(oThis) {
    if (typeof this !== 'function') {
      // closest thing possible to the ECMAScript 5
      // internal IsCallable function
      throw new TypeError('Function.prototype.bind - what is trying to be bound is not callable');
    }

    var aArgs   = Array.prototype.slice.call(arguments, 1),
        fToBind = this,
        fNOP    = function() {},
        fBound  = function() {
          // this instanceof fBound === trueæ—¶,è¯´æ˜è¿”å›çš„fBoundè¢«å½“åšnewçš„æ„é€ å‡½æ•°è°ƒç”¨
          return fToBind.apply(this instanceof fBound
                 ? this
                 : oThis,
                 // è·å–è°ƒç”¨æ—¶(fBound)çš„ä¼ å‚.bind è¿”å›çš„å‡½æ•°å…¥å‚å¾€å¾€æ˜¯è¿™ä¹ˆä¼ é€’çš„
                 aArgs.concat(Array.prototype.slice.call(arguments)));
        };

    // ç»´æŠ¤åŸå‹å…³ç³»
    if (this.prototype) {
      // Function.prototype doesn't have a prototype property
      fNOP.prototype = this.prototype; 
    }
    // ä¸‹è¡Œçš„ä»£ç ä½¿fBound.prototypeæ˜¯fNOPçš„å®ä¾‹,å› æ­¤
    // è¿”å›çš„fBoundè‹¥ä½œä¸ºnewçš„æ„é€ å‡½æ•°,newç”Ÿæˆçš„æ–°å¯¹è±¡ä½œä¸ºthisä¼ å…¥fBound,æ–°å¯¹è±¡çš„__proto__å°±æ˜¯fNOPçš„å®ä¾‹
    fBound.prototype = new fNOP();

    return fBound;
  };
}
```

ä¸Šè¿°ç®—æ³•å’Œå®é™…çš„å®ç°ç®—æ³•è¿˜æœ‰è®¸å¤šå…¶ä»–çš„ä¸åŒ ï¼ˆå°½ç®¡å¯èƒ½è¿˜æœ‰å…¶ä»–ä¸åŒä¹‹å¤„ï¼Œå´æ²¡æœ‰é‚£ä¸ªå¿…è¦å»ç©·å°½ï¼‰


## å‚è€ƒé“¾æ¥

<a href="https://github.com/lin-xin/blog/issues/7" target="_blank">https://github.com/lin-xin/blog/issues/7</a>

<a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Function/apply" target="_blank">https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Function/apply</a>